(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73e702a0"],{"1d4c":function(t,o,e){"use strict";e("62bd")},"62bd":function(t,o,e){},"70c7":function(t,o,e){},9406:function(t,o,e){"use strict";e.r(o);var i=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"profile-box"},[e("div",{staticClass:"box-header"},[e("div",{staticClass:"avatar-wrapper"},[e("div",{staticClass:"avatar-box rotate",on:{click:t.robotInfoEdit}},[e("el-image",{staticStyle:{width:"120px",height:"120px","border-radius":"50%"},attrs:{src:t.robotInfo.qqAvatar,fit:"fit"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t._v("机器人未配置")])])],1)]),e("div",{staticClass:"robot-info"},[e("span",[e("el-tag",{attrs:{size:"small",effect:"dark"}},[t._v(t._s(t.robotInfo.nickname))])],1),e("span",[e("el-tag",{attrs:{size:"small",effect:"dark"}},[t._v(t._s(t.robotInfo.qq))])],1),e("span",{staticStyle:{cursor:"pointer"},on:{click:t.robotStateConfirm}},[e("el-button",{attrs:{type:4==t.robotInfo.state?"success":"info",size:"small"}},[t._v(" "+t._s(t.robotInfo.stateMemo)+" "),e("i",{staticClass:"el-icon--right",class:{"el-icon-loading":4==t.robotInfo.state}})])],1)])]),e("div",{staticClass:"box-nav"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"配置账号",placement:"left-start"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:t.robotInfoEdit}})],1),1!=t.robotInfo.state&&0!=t.robotInfo.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"停止运行",placement:"left-start"}},[e("el-button",{attrs:{type:"danger",icon:"el-icon-switch-button",circle:""},on:{click:t.robotStopConfirm}})],1):t._e(),1==t.robotInfo.state&&0!=t.robotInfo.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"启动运行",placement:"left-start"}},[e("el-button",{attrs:{type:"success",icon:"el-icon-video-play",circle:""},on:{click:t.robotStartSubmit}})],1):t._e(),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"白名单配置",placement:"left-start"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-postcard",circle:""},on:{click:t.allowListConfirm}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"事件设置",placement:"left-start"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-setting",circle:""}})],1)],1),e("el-dialog",{staticClass:"dialog-robot",attrs:{title:"机器人账号配置",visible:t.robotInfoVisible,"append-to-body":!0},on:{"update:visible":function(o){t.robotInfoVisible=o}}},[e("el-form",{ref:"robotForm",attrs:{rules:t.robotRules,model:t.robotForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"QQ号",prop:"qq"}},[e("el-input",{ref:"qq",on:{focus:function(o){t.robotFormFocus.qq=!0},blur:function(o){t.robotFormFocus.qq=!1}},model:{value:t.robotForm.qq,callback:function(o){t.$set(t.robotForm,"qq",o)},expression:"robotForm.qq"}})],1),e("el-form-item",{attrs:{label:"QQ密码",prop:"password"}},[e("el-input",{ref:"password",attrs:{type:"password"},on:{focus:function(o){t.robotFormFocus.password=!0},blur:function(o){t.robotFormFocus.password=!1}},model:{value:t.robotForm.password,callback:function(o){t.$set(t.robotForm,"password",o)},expression:"robotForm.password"}})],1),e("el-form-item",{attrs:{label:"账号昵称",prop:"nickname"}},[e("el-input",{ref:"nickname",on:{focus:function(o){t.robotFormFocus.nickname=!0},blur:function(o){t.robotFormFocus.nickname=!1}},model:{value:t.robotForm.nickname,callback:function(o){t.$set(t.robotForm,"nickname",o)},expression:"robotForm.nickname"}})],1),e("el-form-item",{attrs:{prop:"admins",label:"管理员QQ"}},[e("el-input",{ref:"admins",attrs:{type:"textarea"},on:{focus:function(o){t.robotFormFocus.admins=!0},blur:function(o){t.robotFormFocus.admins=!1}},model:{value:t.robotForm.admins,callback:function(o){t.$set(t.robotForm,"admins",o)},expression:"robotForm.admins"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.robotInfoSubmit}},[t._v("保存")]),e("el-button",{on:{click:function(o){t.robotInfoVisible=!1}}},[t._v("取消")])],1)],1)],1),e("el-dialog",{staticClass:"robot-state-dialog",attrs:{title:"机器人状态",visible:t.robotStateVisible,width:"460px"},on:{"update:visible":function(o){t.robotStateVisible=o}}},[e("h2",{staticClass:"title"},[t._v(t._s(t.robotInfo.stateMemo))]),"SMS"==t.robotVerify.type?e("div",{staticStyle:{"text-align":"center"}},[e("el-tag",[t._v("请接收短信后，填入下方输入框，再点击下面的提交验证按钮")]),e("div",{staticStyle:{display:"flex","justify-content":"center","align-content":"center","font-size":"18px",margin:"20px 0"}},[t._v(t._s(t.robotVerify.content))])],1):t._e(),"SLIDER"==t.robotVerify.type?e("div",{staticStyle:{"text-align":"center"}},[e("el-tag",[t._v("请先阅读"),e("a",{attrs:{href:"https://bbs.molicloud.com/thread/105",target:"_blank"}},[t._v("滑块验证教程"),e("i",{staticClass:"el-icon-top-right el-icon--right"})]),t._v("，再点击下面的提交验证按钮")]),e("el-input",{staticStyle:{margin:"20px 0"},attrs:{type:"textarea",rows:5,placeholder:"验证地址",readonly:""},model:{value:t.robotVerify.content,callback:function(o){t.$set(t.robotVerify,"content",o)},expression:"robotVerify.content"}})],1):t._e(),"URL"==t.robotVerify.type?e("div",{staticStyle:{"text-align":"center"}},[e("el-tag",[t._v("请在新窗口打开验证地址，完成验证后再点击下面的提交验证按钮")]),e("el-input",{staticStyle:{margin:"20px 0"},attrs:{type:"textarea",rows:5,placeholder:"验证地址",readonly:""},model:{value:t.robotVerify.content,callback:function(o){t.$set(t.robotVerify,"content",o)},expression:"robotVerify.content"}})],1):t._e(),"QRCODE"==t.robotVerify.type?e("div",{staticStyle:{"text-align":"center"}},[e("el-tag",[t._v("请用手机QQ扫描下面二维码，完成验证后再点击下面的提交验证按钮")]),e("img",{attrs:{src:"data:image/png;base64,"+t.robotVerify.content}})],1):t._e(),"IMG"==t.robotVerify.type?e("div",{staticClass:"verify-img-box"},[e("img",{attrs:{src:"data:image/png;base64,"+t.robotVerify.content}})]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:"IMG"==t.robotVerify.type||"SLIDER"==t.robotVerify.type||"SMS"==t.robotVerify.type,expression:"robotVerify.type == 'IMG' || robotVerify.type == 'SLIDER' || robotVerify.type == 'SMS'"}]},[e("el-input",{attrs:{type:"primary",placeholder:"请输入验证信息"},model:{value:t.verifyCode,callback:function(o){t.verifyCode=o},expression:"verifyCode"}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(o){t.robotStateVisible=!1}}},[t._v("取 消")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:2==t.robotInfo.state,expression:"robotInfo.state == 2"}],attrs:{type:"primary"},on:{click:t.robotStateSubmit}},[t._v("提交验证")])],1)]),e("el-dialog",{staticClass:"allow-list-dialog",attrs:{title:"白名单配置",visible:t.allowListVisible,width:"460px"},on:{"update:visible":function(o){t.allowListVisible=o}}},[e("el-form",{ref:"allowListForm",attrs:{model:t.allowListForm,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"开启群白名单",prop:"groupAllowListSwitch"}},[e("el-switch",{model:{value:t.allowListForm.groupAllowListSwitch,callback:function(o){t.$set(t.allowListForm,"groupAllowListSwitch",o)},expression:"allowListForm.groupAllowListSwitch"}})],1),e("el-form-item",{attrs:{label:"群白名单",prop:"groupAllowList"}},[e("el-select",{attrs:{disabled:!t.allowListForm.groupAllowListSwitch,multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"多个用回车键确认"},model:{value:t.allowListForm.groupAllowList,callback:function(o){t.$set(t.allowListForm,"groupAllowList",o)},expression:"allowListForm.groupAllowList"}})],1),e("el-form-item",{attrs:{label:"开启好友白名单",prop:"friendAllowListSwitch"}},[e("el-switch",{model:{value:t.allowListForm.friendAllowListSwitch,callback:function(o){t.$set(t.allowListForm,"friendAllowListSwitch",o)},expression:"allowListForm.friendAllowListSwitch"}})],1),e("el-form-item",{attrs:{label:"好友白名单",prop:"friendAllowList"}},[e("el-select",{attrs:{disabled:!t.allowListForm.friendAllowListSwitch,multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"多个用回车键确认"},model:{value:t.allowListForm.friendAllowList,callback:function(o){t.$set(t.allowListForm,"friendAllowList",o)},expression:"allowListForm.friendAllowList"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.allowListSubmit}},[t._v("保存")]),e("el-button",{on:{click:function(o){t.allowListVisible=!1}}},[t._v("取消")])],1)],1)],1)],1)},r=[],s=(e("a15b"),e("b64b"),e("d3b7"),e("ac1f"),e("1276"),e("d354"));function n(){return Object(s["a"])("/sys-setting/robot-info",null)}function a(t){return Object(s["b"])("/sys-setting/robot-info",t)}function l(){return Object(s["a"])("/robot/start",null)}function c(){return Object(s["a"])("/robot/stop",null)}function b(){return Object(s["a"])("/sys-setting/robot-verify",null)}function f(t){return Object(s["c"])("/sys-setting/robot-verify",{code:t})}function u(){return Object(s["a"])("/sys-setting/robot-allow-list",null)}function m(t){return Object(s["b"])("/sys-setting/robot-allow-list",t)}function d(t){return"http://q1.qlogo.cn/g?b=qq&nk="+t+"&s=100"}function p(t){var o="";switch(t){case 1:o="未启动";break;case 2:o="登录需要验证";break;case 3:o="登录中";break;case 4:o="运行中";break;case 9:o="已离线";break;default:o="未配置";break}return o}var w=null,g={name:"DashboardLogin",data:function(){return{robotInfoVisible:!1,robotStateVisible:!1,allowListVisible:!1,verifyCode:"",robotForm:{qq:"",nickname:"",password:"",admins:""},robotFormFocus:{qq:!1,nickname:!1,password:!1,admins:!1},robotInfo:{qq:"",nickname:"",password:"",admins:"",state:0,stateMemo:"",qqAvatar:""},robotVerify:{type:"",content:""},allowListForm:{groupAllowList:"",friendAllowList:"",groupAllowListSwitch:!1,friendAllowListSwitch:!1},robotRules:{qq:[{required:!0,message:"QQ号不能为空",trigger:"blur"}],password:[{required:!0,message:"QQ密码不能为空",trigger:"blur"}],nickname:[{required:!0,message:"账号昵称不能为空",trigger:"blur"}]}}},created:function(){this.initRobotInfo(),w=setInterval(this.initRobotInfo,2e3)},destroyed:function(){clearInterval(w)},methods:{initRobotInfo:function(){var t=this;n().then((function(o){var e=o.data.data;null!=e&&(t.robotInfo.qq=e.qq,t.robotInfo.nickname=e.nickname,t.robotInfo.password=e.password,t.robotInfo.admins=e.admins.join(","),t.robotInfo.state=e.state,t.robotInfo.qqAvatar=d(e.qq),""!=t.robotForm.qq||t.robotFormFocus.qq||(t.robotForm.qq=e.qq),""!=t.robotForm.nickname||t.robotFormFocus.nickname||(t.robotForm.nickname=e.nickname),""!=t.robotForm.password||t.robotFormFocus.password||(t.robotForm.password=e.password),""!=t.robotForm.admins||t.robotFormFocus.admins||(t.robotForm.admins=e.admins.join(","))),t.robotInfo.stateMemo=p(t.robotInfo.state)}))},robotInfoEdit:function(){this.robotInfoVisible=!0},robotInfoSubmit:function(){var t=this;this.$refs["robotForm"].validate((function(o,e){if(o){if(null!=t.robotInfo.state&&0!=t.robotInfo.state&&1!=t.robotInfo.state)return void t.$message.warning("请先停止机器人后再编辑");var i=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"}),r=JSON.parse(JSON.stringify(t.robotForm));r.admins=r.admins.split(","),a(r).then((function(){t.robotInfo.qq=t.robotForm.qq,t.robotInfo.nickname=t.robotForm.nickname,t.robotInfo.password=t.robotForm.password,t.robotInfo.admins=t.robotForm.admins,t.robotInfo.qqAvatar=d(t.robotForm.qq),t.robotInfo.state=1,t.robotInfo.stateMemo=p(1),t.$message.success("保存成功")})).finally((function(){i.close(),t.robotInfoVisible=!1}))}else t.$refs[Object.keys(e)[0]].focus()}))},robotStartSubmit:function(){var t=this,o=this.$loading({lock:!0,text:"启动中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"});l().then((function(){t.$notify({title:"启动中...",message:"请观察机器人头像下方动态，看是否需要登录验证",type:"success",duration:0})})).finally((function(){o.close()}))},robotStopConfirm:function(){var t=this;this.$confirm("确认停止机器人运行吗？").then((function(){var o=t.$loading({lock:!0,text:"停止中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"});c().then((function(){t.$message.success("已停止运行")})).finally((function(){o.close()}))})).catch((function(){}))},robotStateConfirm:function(){var t=this;this.initRobotInfo(),2==this.robotInfo.state&&b().then((function(o){var e=o.data.data;t.robotVerify.type=e.type,t.robotVerify.content=e.content})),this.robotStateVisible=!0},robotStateSubmit:function(){var t=this,o=this.$loading({lock:!0,text:"提交中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"}),e="URL"==this.robotVerify.type?"yes":this.verifyCode;f(e).then((function(){t.$message.success("提交成功")})).finally((function(){o.close(),t.robotStateVisible=!1}))},allowListConfirm:function(){var t=this;this.allowListVisible=!0,u().then((function(o){var e=o.data.data;null!=e&&(t.allowListForm.groupAllowListSwitch=e.groupAllowListSwitch,t.allowListForm.groupAllowList=e.groupAllowList,t.allowListForm.friendAllowListSwitch=e.friendAllowListSwitch,t.allowListForm.friendAllowList=e.friendAllowList)}))},allowListSubmit:function(){var t=this;if(null==this.robotInfo.state||0==this.robotInfo.state||1==this.robotInfo.state){var o=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"}),e=JSON.parse(JSON.stringify(this.allowListForm));m(e).then((function(){t.$message.success("保存成功")})).finally((function(){o.close(),t.allowListVisible=!1}))}else this.$message.warning("请先停止机器人后再编辑")}}},y=g,v=(e("cda4"),e("1d4c"),e("2877")),h=Object(v["a"])(y,i,r,!1,null,"3a3066b3",null);o["default"]=h.exports},a15b:function(t,o,e){"use strict";var i=e("23e7"),r=e("44ad"),s=e("fc6a"),n=e("a640"),a=[].join,l=r!=Object,c=n("join",",");i({target:"Array",proto:!0,forced:l||!c},{join:function(t){return a.call(s(this),void 0===t?",":t)}})},cda4:function(t,o,e){"use strict";e("70c7")}}]);